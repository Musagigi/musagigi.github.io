import{u as q,j as r,T as N,a as b,c as A,b as i,d as P,e as R,f as y,g as E,o as I,S as v,h as W,P as B,i as O,k as h,B as k,l as D,m as G,n as S}from"./index-BpXsuBJG.js";const H={"& .MuiFormLabel-asterisk.MuiInputLabel-asterisk":{color:"red",fontSize:"18px"}},n=({control:e,name:s,label:a,type:t,autoFocus:m,required:d})=>{var c;const{field:p,formState:{errors:l}}=q({name:s,control:e});return r.jsx(N,{...p,label:a,type:t,fullWidth:!0,required:d,autoFocus:m,error:!!l[s],helperText:(c=l[s])==null?void 0:c.message,sx:H})},L=e=>new Promise((s,a)=>{setTimeout(()=>{b.post("/api/auth/registration",e).then(t=>s(t)).catch(t=>a(t))},1e3)}),U=A().shape({firstName:i().required("Поле обязательно к заполнению"),lastName:i().required("Поле обязательно к заполнению"),email:i().email().required("Поле обязательно к заполнению"),login:i().required("Поле обязательно к заполнению"),password:i().min(6,"Пароль должен содержать минимум 6 символов").required("Поле обязательно к заполнению"),confirmPassword:i().oneOf([P("password")],"Пароли должны совпадать").required("Поле обязательно к заполнению")}),_=()=>{const{control:e,handleSubmit:s,setError:a,formState:{isSubmitting:t}}=R({mode:"onBlur",resolver:I(U)}),m=y(),d=E();return{control:e,isSubmitting:t,handleSubmit:s,onSubmit:async l=>{var x;const c=v(l.password).toString(),g={...l,password:c,confirmPassword:c};try{const o=await L(g),{status:u}=o;if(u===200){const{password:j,firstName:w,lastName:F,email:f,login:T}=g;m(W({password:j,firstName:w,lastName:F,email:f,login:T})),d(B,{state:f,replace:!0})}}catch(o){const u=o;b.isAxiosError(o)?(console.log((x=o.response)==null?void 0:x.data),console.log(o)):o instanceof Error?console.log(o):a(u.data.errorField,{type:String(u.status),message:u.data.errorText})}}}},$="Регистрация",M="Поля отмеченные ( * ) обязательны к заполнению",z={flexGrow:1,maxWidth:"520px",padding:"15px",textAlign:"center"},C={display:"flex",flexDirection:" column",alignItems:"center",gap:"15px"},K={margin:"15px 0"},V={color:"red",mb:"20px"},J=()=>{const{control:e,isSubmitting:s,handleSubmit:a,onSubmit:t}=_();return r.jsxs(O,{variant:"outlined",sx:z,children:[r.jsx(h,{component:"h2",variant:"h5",sx:K,children:$}),r.jsx(h,{sx:V,children:M}),r.jsxs(k,{component:"form",onSubmit:a(t),noValidate:!0,sx:C,children:[r.jsx(n,{control:e,name:"firstName",label:"Имя",autoFocus:!0,required:!0}),r.jsx(n,{control:e,name:"lastName",label:"Фамилия",required:!0}),r.jsx(n,{control:e,name:"email",label:"email",required:!0}),r.jsx(n,{control:e,name:"login",label:"Логин",required:!0}),r.jsx(n,{control:e,name:"password",label:"Пароль",type:"password",required:!0}),r.jsx(n,{control:e,name:"confirmPassword",label:"Повторите пароль",type:"password",required:!0}),r.jsx(D,{isSubmitting:s})]})]})},X=()=>{const e=G(S);return localStorage.getItem(S)&&e(),r.jsx(J,{})};export{X as default};
